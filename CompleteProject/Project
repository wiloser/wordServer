优化版本的代码，先分开优化再最终汇总
